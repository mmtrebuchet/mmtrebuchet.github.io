<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Changelog &mdash; BPReveal 4.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom-styles.css?v=f9494c3f" />
      <link rel="stylesheet" type="text/css" href="../_static/libertinus.css?v=d73ac03a" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=e6a937a4"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Checklist" href="releaseChecklist.html" />
    <link rel="prev" title="Developer’s Manifesto" href="philosophy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BPReveal
          </a>
              <div class="version">
                4.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="text.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="majorcli.html">Main CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="minorcli.html">Utility CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolsminor.html">Tools Utility CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolsmajor.html">Tools Main CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolsapi.html">Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="internalapi.html">Internal</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="development.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="philosophy.html">Developer’s Manifesto</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Changelog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bpreveal-4-x">BPReveal 4.x</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-4-1-x">BPReveal 4.1.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-4-0-x">BPReveal 4.0.x</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bpreveal-3-x">BPReveal 3.x</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-6-x">BPReveal 3.6.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-5-x">BPReveal 3.5.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-4-x">BPReveal 3.4.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-3-x">BPReveal 3.3.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-2-x">BPReveal 3.2.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-1-x">BPReveal 3.1.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-3-0-x">BPReveal 3.0.x</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bpreveal-2-x">BPReveal 2.x</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bpreveal-2-0-x">BPReveal 2.0.x</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#previous-versions">PREVIOUS VERSIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="releaseChecklist.html">Release Checklist</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BPReveal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="development.html">Development</a></li>
      <li class="breadcrumb-item active">Changelog</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_generated/changelog.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="changelog">
<h1>Changelog<a class="headerlink" href="#changelog" title="Link to this heading"></a></h1>
<p>This is the detailed changelog. If you’re just looking for breaking changes,
see <a class="reference internal" href="breakingChanges.html"><span class="doc">Breaking Changes</span></a>.</p>
<section id="bpreveal-4-x">
<h2>BPReveal 4.x<a class="headerlink" href="#bpreveal-4-x" title="Link to this heading"></a></h2>
<section id="bpreveal-4-1-x">
<h3>BPReveal 4.1.x<a class="headerlink" href="#bpreveal-4-1-x" title="Link to this heading"></a></h3>
<section id="bpreveal-4-1-1-2024-02-27">
<h4>BPReveal 4.1.1, 2024-02-27<a class="headerlink" href="#bpreveal-4-1-1-2024-02-27" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>The PISA code now runs in parallel if you provide a <code class="docutils literal notranslate"><span class="pre">num-threads</span></code> parameter
in its configuration file. Three-fold speedup is very possible.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Integrated documentation from Melanie on the motif scanning tools.</p></li>
<li><p>Separated type definitions out from the utils module into a new internal.constants
module so that the utils documentation isn’t full of type annotations.</p></li>
<li><p>Combined the old makePredictionsBed and makePredictionsFasta into a single
makePredictions script. The old names will be removed in 6.0.0.</p></li>
<li><p>You can specify a genome name for <code class="docutils literal notranslate"><span class="pre">background-probs</span></code> in
<a class="reference internal" href="motifSeqletCutoffs.html#module-bpreveal.motifSeqletCutoffs" title="bpreveal.motifSeqletCutoffs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">motifSeqletCutoffs</span></code></a> and
<a class="reference internal" href="motifScan.html#module-bpreveal.motifScan" title="bpreveal.motifScan"><code class="xref py py-mod docutils literal notranslate"><span class="pre">motifScan</span></code></a>.</p></li>
<li><p>Rewrote the generator to use a new C library, making the data loading step
at the end of each batch about three times faster. The jitter values will be
slightly different than before since I’m using the random number generator
differently, but there should be no problems with backwards compatibility.
Hooray for better GPU utilization!</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed the name of the counts head in transformation models using bias counts from
<code class="docutils literal notranslate"><span class="pre">combined_log_counts_&lt;headname&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">combined_logcounts_&lt;headname&gt;</span></code>, making
<code class="docutils literal notranslate"><span class="pre">use-bias-counts</span></code> compatible with adaptive loss and the new training progress
logger. (Melanie Weilert)</p></li>
<li><p>Corrected a bug where non-links in the documentation still showed up as blue.
(Thanks to Patrick Moeller for the fix!)</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert, Patrick Moeller, Charles McAnany</p>
</dd>
</dl>
</section>
<section id="bpreveal-4-1-0-2024-02-16">
<h4>BPReveal 4.1.0, 2024-02-16<a class="headerlink" href="#bpreveal-4-1-0-2024-02-16" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES:</dt><dd><ul class="simple">
<li><p>The output from training now has a radically different format. If you were parsing
progress bars from log files, I hope that the new format will make your life
easier.</p></li>
</ul>
</dd>
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Extracted the logging functions into a new module,
<a class="reference internal" href="logUtils.html#module-bpreveal.logUtils" title="bpreveal.logUtils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logUtils</span></code></a>. It separates BPReveal logging into
its own class of messages, so you can still use logging with your own
code without stepping on BPReveal’s toes.</p></li>
<li><p>Removed the old progress bar logging system during training. Training now produces
a spew of logging messages that are easier to grep, and they can be displayed in
real time by the new <a class="reference internal" href="showTrainingProgress.html#module-bpreveal.showTrainingProgress" title="bpreveal.showTrainingProgress"><code class="xref py py-mod docutils literal notranslate"><span class="pre">showTrainingProgress</span></code></a>
tool. This tool requires training the model with INFO or DEBUG verbosity, otherwise
no useful output is produced. The format of the output is still flexible and will
not be finalized until 4.3.0.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Added parallelization to <a class="reference internal" href="prepareBed.html#module-bpreveal.prepareBed" title="bpreveal.prepareBed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">prepareBed</span></code></a>.
It should now be a lot faster. Output is bit-for-bit identical.</p></li>
<li><p>Dramatically sped up the whitelist calculation for tiling the genome in
<a class="reference internal" href="bedUtils.html#bpreveal.bedUtils.makeWhitelistSegments" title="bpreveal.bedUtils.makeWhitelistSegments"><code class="xref py py-func docutils literal notranslate"><span class="pre">makeWhitelistSegments</span></code></a>.</p></li>
<li><p>Made the verbosity of the training step match the user-specified verbosity.
If your configuration json says that verbosity should be <code class="docutils literal notranslate"><span class="pre">WARNING</span></code>, then there
is much less output from the training scripts.</p></li>
<li><p>Switched the documentation to a serif font.</p></li>
<li><p>Cleaned up the documentation building process a lot.</p></li>
</ul>
</dd>
<dt>DEPRECATIONS:</dt><dd><ul class="simple">
<li><p>The showModel script is deprecated and will be removed in 6.0.0.
It does very little and required two large dependencies (pydot and graphviz)
to get the image out.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>The <a class="reference internal" href="motifAddQuantiles.html#module-bpreveal.motifAddQuantiles" title="bpreveal.motifAddQuantiles"><code class="xref py py-mod docutils literal notranslate"><span class="pre">motifAddQuantiles</span></code></a> script used to add
a new copy of quantile information if the file already had that data. Now it
replaces the old quantile information.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-4-0-x">
<h3>BPReveal 4.0.x<a class="headerlink" href="#bpreveal-4-0-x" title="Link to this heading"></a></h3>
<section id="version-4-0-4-2024-02-07">
<h4>Version 4.0.4, 2024-02-07<a class="headerlink" href="#version-4-0-4-2024-02-07" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a bug that prevented <code class="docutils literal notranslate"><span class="pre">null</span></code> quantile cutoffs in
<a class="reference internal" href="motifAddQuantiles.html#module-bpreveal.motifAddQuantiles" title="bpreveal.motifAddQuantiles"><code class="xref py py-mod docutils literal notranslate"><span class="pre">motifAddQuantiles</span></code></a>.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-4-0-3-2024-01-30">
<h4>Version 4.0.3, 2024-01-30<a class="headerlink" href="#version-4-0-3-2024-01-30" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a bug in the Easy prediction function incorrectly assuming that models
had only one output.</p></li>
<li><p>Added pydot and graphviz as optional components in the build script, only
necessary to use the graphical output from showModel.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-4-0-2-2024-01-29">
<h4>Version 4.0.2, 2024-01-29<a class="headerlink" href="#version-4-0-2-2024-01-29" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES:</dt><dd><ul class="simple">
<li><p>A few internal variable names were switched from snake_case to camelCase.
This should not have any effect on code that uses BPReveal.</p></li>
</ul>
</dd>
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added a feature to
<code class="xref py py-mod docutils literal notranslate"><span class="pre">makePredictionsFasta</span></code> where you
can specify a bed file and a genome. If you do, then the coordinate
information from that bed will be saved in the output h5 and you can use
<a class="reference internal" href="predictToBigwig.html#module-bpreveal.predictToBigwig" title="bpreveal.predictToBigwig"><code class="xref py py-mod docutils literal notranslate"><span class="pre">predictToBigwig</span></code></a> with it. Added the
same feature to interpretFlat, so you can use it with
<a class="reference internal" href="shapToBigwig.html#module-bpreveal.shapToBigwig" title="bpreveal.shapToBigwig"><code class="xref py py-mod docutils literal notranslate"><span class="pre">shapToBigwig</span></code></a>.</p></li>
<li><p>Two new functions:
<a class="reference internal" href="utils.html#bpreveal.utils.blankChromosomeArrays" title="bpreveal.utils.blankChromosomeArrays"><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.blankChromosomeArrays</span></code></a>
and <a class="reference internal" href="utils.html#bpreveal.utils.writeBigwig" title="bpreveal.utils.writeBigwig"><code class="xref py py-func docutils literal notranslate"><span class="pre">utils.writeBigwig</span></code></a></p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>A complete overhaul of the documentation means that we now have on-line
docs for all of the components of BPReveal, all with type annotations.
The old overview.pdf has been removed and split up across many webpages.</p></li>
<li><p>Many functions that were previously undocumented are now
fully-documented.</p></li>
<li><p>Automated the testing of schemas. The runTests.py script will
automatically go through all the test cases.</p></li>
<li><p>Added new arguments to
<code class="xref py py-func docutils literal notranslate"><span class="pre">utils.loadChromSizes&lt;bpreveal.utils.loadChromSizes()</span></code>. These let
you pass in things other than a <code class="docutils literal notranslate"><span class="pre">chrom.sizes</span></code> file name. You can now
provide a genome fasta, a bigwig, and a bunch of other things.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>The dummy progress bar for an int passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">utils.wrapTqdm</span></code> returned the dummyPbar
<em>class</em>, not an <em>object</em>. This has been fixed.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-4-0-1-2024-01-17">
<h4>Version 4.0.1, 2024-01-17<a class="headerlink" href="#version-4-0-1-2024-01-17" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added the option to specify the kmer size for the shuffles in shap value
calculations. interpretFlat and interpretPisa now have an optional
“kmer-size” parameter in their configuration jsons. If omitted, the
default (non-kmer-preserving) shuffle is performed.</p></li>
<li><p>There are now easy functions that you can use to make predictions and get
interpretation scores in <a class="reference internal" href="utils.html#module-bpreveal.utils" title="bpreveal.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code></a>.</p></li>
<li><p>A new
<a class="reference internal" href="utils.html#bpreveal.utils.ThreadedBatchPredictor" title="bpreveal.utils.ThreadedBatchPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadedBatchPredictor</span></code></a>
runs predictions in another thread, and lets you hold it in a context
manager so that it shuts down and starts up when you need it.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>All BPReveal programs that take JSON input now check that input against a
schema.</p></li>
<li><p>Lots of enhancements to the pisa plotting tools!</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">makePredictionsFasta</span></code> used a
non-iterable tqdm object as an iterable in a loop. This has been fixed.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="version-4-0-0-2024-01-10">
<h4>Version 4.0.0, 2024-01-10<a class="headerlink" href="#version-4-0-0-2024-01-10" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES:</dt><dd><ul class="simple">
<li><p>interpretFlat now produces h5 files that use integer indexes for the
chromosome instead of strings. Internal programs that were affected by
this change now emit a warning if they detect an importance file from an
earlier release.</p></li>
<li><p>The adaptive loss is now named reweightableMse, and comes from a function
in losses.py called weightedMse. If you’re just loading a model, you can
specify “custom_objects={‘multinomialNll’: losses.multinomialNll,
‘reweightableMse’: losses.dummyMse}” when you call load_model in keras.
There’s also a new loadModel function in utils.py that does this for you.</p></li>
</ul>
</dd>
<dt>DEPRECATIONS:</dt><dd><ul class="simple">
<li><p>interpretPisaBed and interpretPisaFasta have been merged into one
program, interpretPisa. Symlinks exist in the bin/ directory; using one
will generate a warning until 6.0.0, when the symlinks will be removed.</p></li>
<li><p>interpretPisa now expects a property called “fasta-file”, (consistent
with interpretFlat), instead of the old “sequence-fasta” property. This
will generate a warning until 6.0.0, when it will become an error.</p></li>
<li><p>The old json format for prepareBed has produced a warning since 3.3.1. It
will be an error in 5.0.0</p></li>
<li><p>Using an old-style importance score hdf5 (with string chromosome names)
is now a warning, and will become an error in 6.0.0.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>All queues now have a timeout, so that a crash in one thread will
propagate through the entire program instead of freezing.</p></li>
<li><p>Started working on json schemas to validate inputs, hopefully making
errors less opaque. All of the programs except the motif scanners have
schemas now. (Thanks to Melanie for lighting the fire that led to this!)</p></li>
<li><p>Plenty of code cleanups and tweaks.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a typo in interpretUtils.py (Thanks, Haining!)</p></li>
<li><p>The specification incorrectly stated that the warning level of verbosity
was “WARN”, when in fact it should be “WARNING”.</p></li>
<li><p>Fixed the install script to use tensorflow 2.15, which requires cuda 12.</p></li>
<li><p>The automatic memory allocation in interpretFlat
(utils.py/limitMemoryUsage) worked incorrectly if running on a MIG gpu.
This has been remedied with an extremely ugly hack that looks at
CUDA_VISIBLE_DEVICES and sees if there’s a MIG entry. If so, it estimates
the available memory based on the MIG type’s name (like 3g.20gb).</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany, Haining Jiang, Melanie Weilert</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="bpreveal-3-x">
<h2>BPReveal 3.x<a class="headerlink" href="#bpreveal-3-x" title="Link to this heading"></a></h2>
<section id="bpreveal-3-6-x">
<h3>BPReveal 3.6.x<a class="headerlink" href="#bpreveal-3-6-x" title="Link to this heading"></a></h3>
<section id="version-3-6-1-2023-12-05">
<h4>Version 3.6.1, 2023-12-05<a class="headerlink" href="#version-3-6-1-2023-12-05" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Added a version of ushuffle that is compatible with python 3.11. This is
now part of the main bpreveal repository, in the src/internal directory.</p></li>
<li><p>Implemented an adaptive counts loss weight algorithm, so you can specify
the fraction of the loss due to counts instead of a raw <span class="math notranslate nohighlight">\({\lambda}\)</span>
parameter.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-6-0-2023-11-06">
<h4>Version 3.6.0, 2023-11-06<a class="headerlink" href="#version-3-6-0-2023-11-06" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>The old predictToBigwig script had odd behavior with overlapping inputs.
It always took the leftmost region that predicted a particular base and
saved that out. Now, it instead averages all of the predictions made for
a given base and saves the average value. This may result in small
changes to your bigwigs, but should not cause any meaningful differences.
predictToBigwig now has a –threads option, since I made it GO FAST LIKE
NYOOOOM! Since this cause a change in outputs, I’m assigning a minor
version increase, though it’s really not a big deal.</p></li>
<li><p>Fully qualified the names of all the imports in all the python files, so
they should be callable from anywhere and importable from any script now.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>In the specification, corrected “chrom_name” to “chrom_names” in the
output hdf5 format for makePredictionsBed.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-5-x">
<h3>BPReveal 3.5.x<a class="headerlink" href="#bpreveal-3-5-x" title="Link to this heading"></a></h3>
<section id="version-3-5-3-2023-11-03">
<h4>Version 3.5.3, 2023-11-03<a class="headerlink" href="#version-3-5-3-2023-11-03" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added a bedUtils.py library with useful tools for manipulating bed files.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Added fully qualified imports to several files, allowing you to import
them from other directories.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-5-2-2023-10-26">
<h4>Version 3.5.2, 2023-10-26<a class="headerlink" href="#version-3-5-2-2023-10-26" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added a script to calculate the right counts loss weight given a model
training history json.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a typing bug in motifUtils that made motif scanning not work.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-5-1-2023-10-23">
<h4>Version 3.5.1, 2023-10-23<a class="headerlink" href="#version-3-5-1-2023-10-23" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Building conda environments is always haunted. Fixed problems with model
training scripts not being able to find the cuda tools on Cerebro (even
though they’re found just fine on my local workstation!)</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-5-0-2023-10-17">
<h4>Version 3.5.0, 2023-10-17<a class="headerlink" href="#version-3-5-0-2023-10-17" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES</dt><dd><ul class="simple">
<li><p>This should not have any effects on typical uses, but BPReveal now uses
Python 3.11.</p></li>
<li><p>Removed the compiled jaccard library, the install process now
automatically builds it. You’ll need to re-install BPReveal (or run make
in the src directory).</p></li>
</ul>
</dd>
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Created a directory of helpful tools under src/tools. These are not part
of BPReveal proper, but have some useful goodies for plotting and stuff.
Pull requests welcome for new tools!</p></li>
<li><p>Added the ability to provide sequence fasta files to interpretFlat.py
this required a total rewrite of the interpretation code to use
streaming. interpretFlat now requires just a few gigs of memory. It also
calculates profile and counts contribution simultaneously, leading to a
60% speedup.</p></li>
<li><p>Created better conda integration. The BPReveal libraries should be on
your python path when you open python, and they are in the bpreveal
package. You can now <cite>import bpreveal.utils</cite> from any python interpreter.
Also created a bin/ directory that has links to all of the BPReveal
scripts. You should be able to just run <cite>trainSoloModel config.json</cite> once
you’ve activated the conda environment.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Switched to storing importance scores as 16-bit floating point values and
enabled hdf5 compression, leading to an 80% reduction in the size of
contribution hdf5 files. Upgraded several components to effectively read
and write in a compressed, block-oriented format.</p></li>
<li><p>Added type annotations to most of the library functions, allowing your
editor to quickly check for mistakes in argument order and type.</p></li>
<li><p>Added type definitions to utils.py, so the code now (mostly) uses
consistent definitions for variable types.</p></li>
<li><p>Updated the build scripts and added one for building a local copy of the
BPReveal environment.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-4-x">
<h3>BPReveal 3.4.x<a class="headerlink" href="#bpreveal-3-4-x" title="Link to this heading"></a></h3>
<section id="version-3-4-0-2023-10-06">
<h4>Version 3.4.0, 2023-10-06<a class="headerlink" href="#version-3-4-0-2023-10-06" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>CWM scanning is now implemented. This takes the output from modisco and
uses contribution scores to look for motif instances across the genome.
The documentation has been updated. Thanks to Melanie Weilert for an
initial BPReveal-compatible implementation of CWM scanning.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert, Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-3-x">
<h3>BPReveal 3.3.x<a class="headerlink" href="#bpreveal-3-3-x" title="Link to this heading"></a></h3>
<section id="version-3-3-2-2023-09-19">
<h4>Version 3.3.2, 2023-09-19<a class="headerlink" href="#version-3-3-2-2023-09-19" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Updated the conda install script to be compatible with Tensorflow 2.12.
The tensorflow-probability package that had been installed was too old,
so I have changed to getting tensorflow and tensorflow-probability from
conda. The build script also installs mamba, which seemed to work better
for me.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-3-1-2023-08-30">
<h4>Version 3.3.1, 2023-08-30<a class="headerlink" href="#version-3-3-1-2023-08-30" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Added a “heads” section to prepareBed.py json files. This lets you
combined multiple bigwigs just as you do for the final model. The old
“bigwigs” section is now deprecated, and will be removed in BPReveal 5.0.
Previously, if you had a two-task head, prepareBed.py would reject any
region where <em>either</em> of those tasks was outside of your counts limits.
The new version adds the bigwigs in each head together before doing the
counts culling. This is useful when one track has zero reads but the
other still has data. Thanks to Melanie for suggesting this feature.</p></li>
<li><p>Finally ran through shap.py and fixed formatting.</p></li>
<li><p>Added two features to metrics.py. First, for regions that are empty,
metrics.py now has a feature to simply ignore those regions rather than
using them in counts correlations (they were always ignored in profile
correlations). Second, added a feature to generate json output for ease
of parsing.</p></li>
<li><p>Added three utility functions to gaOptimize.py for easily converting
lists of corruptors to and from strings and numerical arrays. Thanks to
Haining Jiang for suggesting these.</p></li>
</ul>
</dd>
<dt>DEPRECATIONS:</dt><dd><ul class="simple">
<li><p>The “bigwigs” section in prepareBed.py json files has been deprecated and
will become an error in BPReveal 5.0.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert, Charles McAnany.</p>
</dd>
</dl>
</section>
<section id="version-3-3-0-2023-06-23">
<h4>Version 3.3.0, 2023-06-23<a class="headerlink" href="#version-3-3-0-2023-06-23" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added a genetic algorithm module. See the demo pdfs for how to use them.</p></li>
<li><p>Added a batch-running tool to utils.py, this lets you run many sequences
through your model without worrying about constructing batches
efficiently.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Rewrote makePredictionsFasta to stream data in and out. It is now quite
fast and uses very little memory.</p></li>
<li><p>Updated the OSKN demo python notebook to be compatible with version 3.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-2-x">
<h3>BPReveal 3.2.x<a class="headerlink" href="#bpreveal-3-2-x" title="Link to this heading"></a></h3>
<section id="version-3-2-0-2023-05-17">
<h4>Version 3.2.0, 2023-05-17<a class="headerlink" href="#version-3-2-0-2023-05-17" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Previously, if a solo model had a different input length than the
residual model, you could not combine them. Melanie added logic so that
if the solo model has a smaller input length (for example, because it has
fewer layers), the sequence will automatically be cropped down to match
it. In this way, you don’t have to match solo and residual architectures
any more.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Further re-formatting to comply with PEP8.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert (cropdown logic), Charles McAnany (code cleanup)</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-1-x">
<h3>BPReveal 3.1.x<a class="headerlink" href="#bpreveal-3-1-x" title="Link to this heading"></a></h3>
<section id="version-3-1-0-2023-05-14">
<h4>Version 3.1.0, 2023-05-14<a class="headerlink" href="#version-3-1-0-2023-05-14" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NEW FEATURES:</dt><dd><ul class="simple">
<li><p>Added an automatic reverse complement strand selection feature. Instead
of saying ‘“revcomp-task-order” : [1,0]’, you can now say
‘“revcomp-task-order”:”auto”’ when you have one or two tasks in a head.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Code cleanup in general, such as removing unused imports and tidying up
formatting.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a missing import in prepareBed.py that broke the regex mode.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
</section>
<section id="bpreveal-3-0-x">
<h3>BPReveal 3.0.x<a class="headerlink" href="#bpreveal-3-0-x" title="Link to this heading"></a></h3>
<section id="version-3-0-1-2023-04-26">
<h4>Version 3.0.1, 2023-04-26<a class="headerlink" href="#version-3-0-1-2023-04-26" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Formatted the code throughout the repository to more closely comply with
PEP8.</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>Fixed a bug in argument order for deduplicating in prepareBed.py</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-3-0-0-2023-03-10">
<h4>Version 3.0.0, 2023-03-10<a class="headerlink" href="#version-3-0-0-2023-03-10" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES:</dt><dd><ul class="simple">
<li><p>There is a new “remove-overlaps” field that is mandatory in prepareBed.py
json files. If set to true, then you can set how close two peaks must be
before they are considered overlapping. (Thanks to Melanie Weilert for
the implementation.)</p></li>
<li><p>On discussion with Melanie, it occurred that the cropdown feature of the
transformation model is never appropriate. Therefore, this feature has
been removed.  Instead, in a future version, there will be a feature to
crop down the input sequence to the solo model during training the
combined model. (Charles McAnany)</p></li>
<li><p>Since there is no cropping, it was silly to call the input-length
“sequence-input-length” inside the transformation config json. It is now
sensibly called “input-length”.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>The PISA code was totally rewritten; it now uses a streaming architecture
so that loading the data, calculating shap scores, and saving data are
done by different threads. This cuts way down on memory use, and makes it
possible to run pisa over an entire genome. (generating 100 GiB per
megabase or so.) (Charles McAnany)</p></li>
</ul>
</dd>
<dt>BUG FIXES:</dt><dd><ul class="simple">
<li><p>In the combined config, the documentation called a parameter
“output-directory”, but the code expected “output-prefix”. The
documentation has been corrected. (Charles McAnany)</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert, Charles McAnany.</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="bpreveal-2-x">
<h2>BPReveal 2.x<a class="headerlink" href="#bpreveal-2-x" title="Link to this heading"></a></h2>
<section id="bpreveal-2-0-x">
<h3>BPReveal 2.0.x<a class="headerlink" href="#bpreveal-2-0-x" title="Link to this heading"></a></h3>
<section id="version-2-0-2-2023-02-17">
<h4>Version 2.0.2, 2023-02-17<a class="headerlink" href="#version-2-0-2-2023-02-17" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>interpretPisaBed.py will now include predictions and reference
predictions in the output hdf5.</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-2-0-1-2023-02-09">
<h4>Version 2.0.1, 2023-02-09<a class="headerlink" href="#version-2-0-1-2023-02-09" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>prepareBed.py will no longer replace the names in your bed files; the
generated files will have the same names as the input beds. (Suggested by
Melanie)</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Melanie Weilert, Charles McAnany</p>
</dd>
</dl>
</section>
<section id="version-2-0-0-2023-02-07">
<h4>Version 2.0.0, 2023-02-07<a class="headerlink" href="#version-2-0-0-2023-02-07" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>BREAKING CHANGES:</dt><dd><ul class="simple">
<li><p>Added a reverse-complement flag to prepareTrainingData.py. If this is set
to true, then you must specify strand mappings to each of the heads in
that file. If you want your code to behave like before, just set
“reverse-complement” to false in the json file for
prepareTrainingData.py.</p></li>
</ul>
</dd>
<dt>ENHANCEMENTS:</dt><dd><ul class="simple">
<li><p>Reverse complement support added, see overview.tex in the section on
prepareTrainingData.py. (Charles McAnany)</p></li>
</ul>
</dd>
<dt>CONTRIBUTORS:</dt><dd><p>Charles McAnany.</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="previous-versions">
<h2>PREVIOUS VERSIONS<a class="headerlink" href="#previous-versions" title="Link to this heading"></a></h2>
<p>Versions of BPReveal before 2.0.0 are not recorded here, but the software
would not have been completed without help from Julia Zeitlinger, Anshul
Kundaje, and Melanie Weilert.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="philosophy.html" class="btn btn-neutral float-left" title="Developer’s Manifesto" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="releaseChecklist.html" class="btn btn-neutral float-right" title="Release Checklist" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Charles McAnany.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>